---
layout: post
title: "The Signal Protocol Part II: The Diffieâ€“Hellman Key Exchange"
comments: true
date: 2020-01-06
---

Change of plan: In this post I'll discuss the Diffie-Hellman key exchange (only, rather than the all of the primitives) in increasing levels of complexity, from the original formulation to the Signal protocol's "Extended Triple Diffie-Hellman."

<h2>The Basic Diffie-Hellman Key Exchange</h2>

The Diffie-Hellman is a means for two parties to securely agree on a shared encryption key, assuming there is a trustworthy public server (a bulletin board in clear view of the public, for instance). The shared encryption key may then be used to encrypt further communications.

<p> The idea is simple: the shared key will be 
<div class="media">
 <b>g^(ab) mod N,</b> 
</div>

where <b>g</b> and <b>N</b> needn't be secure (and in some ways are better if public). Every number here should be sufficiently large to make brute force reversals difficult/impossible. Here, <b>a</b> is a secret <i>private key</i> known only to Alice, and <b>b</b> only to Bob. By the commutativity of multiplication, this may be computed as in any of the following three ways: 
<div class="media">
 <b>g^(ab) mod N = (g^a)^b mod N = (g^b)^a mod N.</b>
</div>
The point is that from <b>g^a mod N</b> (known as Alice's <i>public key</i>) it is difficult to retrieve Alice's private key <b>a</b>, so it can be (and is) shared freely. In particular, Bob can use it to comute the shared key. And by symmetry, Alice likewise.

<p>Remarks on the weakness of this protocol:
 
<ul>
<li>I was discussing last time the trustworthiness of the server. If it is not trustworthy (eg. the bulletin board is not in public view), then sadly we are in a Matrix-like situation: The entity controlling the board can make Alice believe anything, including that she is talking to Bob, by simply manufacturing an identity and scrawling onto the bulletin board all the things Bob would (other than "being" Bob). The only way around this is to take the red pill and contact Bob in real life.
    
<li> The above attack is known as a <i>man-in-the-middle</i> attack. It assumes the server is not just an eavesdropper but can tinker with messages.
</ul>

To address this, we next discuss:

<h2>Diffie-Hellman with Authentication: The Station-to-Station Protocol</h2>

This is simply a way to systematize "contacting Bob in real life" discussed in the remarks above.
